# ğŸŒ blog-backend

## ğŸ“Œ 1. í”„ë¡œì íŠ¸ ì†Œê°œ

**ê¸°ê°„: (2024.06 ~ .)**

#### í”„ë¡œì íŠ¸ ì£¼ì œ ì„ ì • ë°°ê²½

í•™ë¶€ ì‹œì ˆ ì—¬ëŸ¬ íŒ€ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í–ˆì§€ë§Œ, ì‹¤ì§ˆì ìœ¼ë¡œ ìš´ì˜ ë° ìœ ì§€ ë³´ìˆ˜í•œ ê²½í—˜ì€ ì—†ì—ˆìŠµë‹ˆë‹¤.

ë‹¤ì–‘í•œ ì•„ì´ë””ì–´ë¥¼ ê³ ë¯¼í•œ ëì—, ê¸°ëŠ¥ì„ ììœ ë¡­ê²Œ í™•ì¥í•˜ê³  ìˆ˜ì •í•˜ë©° ì§€ì†ì ìœ¼ë¡œ ê°œì„ í•  ìˆ˜ ìˆëŠ” ë¸”ë¡œê·¸ ì„œë¹„ìŠ¤ë¥¼ ê°œë°œí•˜ëŠ” ê²ƒì´ ì ì ˆí•˜ë‹¤ê³  íŒë‹¨í–ˆìŠµë‹ˆë‹¤.

#### ê³¼ê±° ê²½í—˜ì„ ë°”íƒ•ìœ¼ë¡œ ê°œì„ í•œ ì 

- **ìš´ì˜ ë° ìœ ì§€ ë³´ìˆ˜**
  - ì‚¬ìš©ìê°€ ì ë”ë¼ë„ ì‹¤ì œ ì„œë¹„ìŠ¤ ìš´ì˜ì—ì„œ ê²ªì„ ìˆ˜ ìˆëŠ” ë¬¸ì œë“¤ì„ ì§ì ‘ ê²½í—˜í•˜ê³  ê°œì„ í•  ìˆ˜ ìˆëŠ” í”„ë¡œì íŠ¸ ê°œë°œì„ ëª©í‘œë¡œ í–ˆìŠµë‹ˆë‹¤.
- **íš¨ìœ¨ì ì¸ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜**
  - ë¬¸ì œ: íŒ€í”„ë¡œì íŠ¸ì—ì„œ ì£¼ë¡œ êµ¬ë‘ë¡œ í˜‘ì—…ì„ ì§„í–‰í–ˆìŠµë‹ˆë‹¤.
  - ê°œì„ : GitHub Issue, PR ê¸°ëŠ¥ì„ ì ê·¹ í™œìš©í–ˆìœ¼ë©°, API ë¬¸ì„œí™” ë„êµ¬ë¥¼ ë„ì…í–ˆìŠµë‹ˆë‹¤.
- **í…ŒìŠ¤íŠ¸ ì½”ë“œ**
  - ë¬¸ì œ: ì‹œì—° ì¤‘ ê°‘ì‘ìŠ¤ëŸ¬ìš´ ê¸°ëŠ¥ ì˜¤ë¥˜ë¡œ ì¸í•´ ë¬¸ì œê°€ ë°œìƒí•œ ì ì´ ìˆìŠµë‹ˆë‹¤.
  - ê°œì„ : ëª¨ë“  ì£¼ìš” ê¸°ëŠ¥ì— ëŒ€í•´ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.

#### ê°œë°œ ì£¼ìš”ì‚¬í•­

- **ì‚¬ìš©ì ì¸ì¦:** JWT, Google OAuth 2.0, RBAC(Role-Based Access Control)
- **CRUD ê¸°ëŠ¥ êµ¬í˜„:** ë¸”ë¡œê·¸ ì„œë¹„ìŠ¤ ê´€ë ¨ API ê°œë°œ ë° ì´ë¯¸ì§€ ì—…ë¡œë“œ ê¸°ëŠ¥ ì¶”ê°€
- **í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±:** Unit, Integration, E2E í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±
- **í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ:** ì„œë²„ ì—°ë™ ë° SEO ìµœì í™” ì ìš©
- **ë¼ì¦ˆë² ë¦¬íŒŒì´ ì›¹ ì„œë²„ ì„¤ì •**

## ğŸ“Œ 2. ê¸°ìˆ  ìŠ¤íƒ

![image](https://github.com/user-attachments/assets/e588c142-8ded-483d-a395-e04dcddf56a6)


| **ê¸°ìˆ **       | **ì„¤ëª…**                                                                                                                                 |
| -------------- | ---------------------------------------------------------------------------------------------------------------------------------------- |
| **TypeScript** | í•˜ë‚˜ì˜ ì–¸ì–´ë¡œ ë°±ì—”ë“œì™€ í”„ë¡ íŠ¸ì—”ë“œë¥¼ ê°œë°œ ê°€ëŠ¥, ì»´íŒŒì¼ íƒ€ì„ì— ì˜ë„ì¹˜ ì•Šì€ ì˜¤ë¥˜ë¥¼ í™•ì¸í•  ìˆ˜ ìˆì–´ ìœ ì§€ ë³´ìˆ˜ ìš©ì´                            |
| **NestJS**     | ììœ ë„ê°€ ë†’ì€ Express ëŒ€ì‹ , ì¢€ ë” êµ¬ì¡°ì ì´ê³  ê³„ì¸µí™”ëœ í”„ë ˆì„ì›Œí¬ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜, ì½”ë“œ ê°€ë…ì„±ê³¼ ìœ ì§€ ë³´ìˆ˜ì„± í–¥ìƒ                          |
| **Next.js**    | ë¸”ë¡œê·¸ ì„œë¹„ìŠ¤ íŠ¹ì„±ìƒ ê²€ìƒ‰ ì—”ì§„ì— ì˜ ë…¸ì¶œë˜ì–´ì•¼ í•˜ë¯€ë¡œ, SEO ìµœì í™”ë¥¼ ì‰½ê²Œ í•  ìˆ˜ ìˆëŠ” í”„ë ˆì„ì›Œí¬ ì„ íƒ, ì·¨ì—… ì‹œì¥ì— ë§ì¶° ê³µë¶€ ëª©ì ìœ¼ë¡œ ì„ íƒ |
| **MySQL**      | ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„ì™€ í•™ìŠµ ëª©ì                                                                                                      |
| **Prisma**     | TypeORMë³´ë‹¤ ì§ê´€ì ì¸ ìŠ¤í‚¤ë§ˆ ì‘ì„± ê°€ëŠ¥, ì¢€ ë” í¸ë¦¬í•˜ê²Œ ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ìˆ˜í–‰ ë° ê´€ë¦¬ ê°€ëŠ¥                                                |

## ğŸ“Œ 2. ì•„í‚¤í…ì²˜

#### ì „ì²´ì ì¸ ì„œë¹„ìŠ¤ êµ¬ì¡°

![image](https://github.com/user-attachments/assets/231a7d3b-c3fa-434e-8679-b2a7520ef191)

## ğŸ“Œ 3. í”„ë¡œì íŠ¸ ë§í¬

#### í”„ë¡œì íŠ¸ ë°°í¬ ì£¼ì†Œ

https://jongdeug.ddns.net

#### â­ Trouble Shooting ê¸°ë¡ â­

https://github.com/users/JongDeug/projects/9/views/3

#### ê¸°ëŠ¥ ê°œë°œ ê¸°ë¡

https://github.com/users/JongDeug/projects/9/views/1

#### Swagger ë°°í¬ ì£¼ì†Œ

https://jongdeug.ddns.net/api/nest/docs

#### í”„ë¡ íŠ¸ì—”ë“œ ê¹ƒí—ˆë¸Œ

https://github.com/JongDeug/blog-frontend

## ğŸ“Œ 5. API ëª…ì„¸ì„œ

| êµ¬ë¶„             | ê¸°ëŠ¥ëª…                 | HTTP Method | REST API                                   | JWT | ROLE(í•˜ìœ„ ë²”ì£¼) |
| ---------------- | ---------------------- | ----------- | ------------------------------------------ | --- | --------------- |
| 1. íšŒì› ê´€ë¦¬     | 1.1 ì´ë©”ì¼ ê°€ì…        | POST        | /auth/register                             | X   | ALL             |
|                  | 1.2 ë¡œê·¸ì¸             | POST        | /auth/login                                | X   | ALL             |
|                  | 1.3 ë¡œê·¸ì•„ì›ƒ           | GET         | /auth/logout                               | O   | USER            |
|                  | 1.4 ë¡œê·¸ì¸ ê°±ì‹         | GET         | /auth/token/refresh                        | O   | USER            |
|                  | 1.5 í† í° ë¬´íš¨í™”        | GET         | /auth/token/revoke/:id                     | O   | ADMIN           |
|                  | 1.6 ìœ ì € ëª©ë¡ ì¡°íšŒ     | GET         | /user                                      | O   | ADMIN           |
|                  | 1.7 ìœ ì € ìƒì„¸ ì¡°íšŒ     | GET         | /user/:id                                  | O   | ADMIN           |
|                  | 1.8 ìœ ì € ì‚­ì œ          | DELETE      | /user/:id                                  | O   | ADMIN           |
| 2. ê²Œì‹œê¸€ ê´€ë¦¬   | 2.1 ê²Œì‹œê¸€ ëª©ë¡ ì¡°íšŒ   | GET         | /post?search=&take=&draft=&cursor=&order[] | X   | ALL             |
|                  | 2.2 ê²Œì‹œê¸€ ìƒì„¸ ì¡°íšŒ   | GET         | /post/:id                                  | X   | ALL             |
|                  | 2.3 ê²Œì‹œê¸€ ë“±ë¡        | POST        | /post                                      | O   | ADMIN           |
|                  | 2.4 ê²Œì‹œê¸€ ìˆ˜ì •        | PATCH       | /post/:id                                  | O   | ADMIN           |
|                  | 2.5 ê²Œì‹œê¸€ ì‚­ì œ        | DELETE      | /post/:id                                  | O   | ADMIN           |
|                  | 2.6 ê²Œì‹œê¸€ ì¢‹ì•„ìš”      | POST        | /post/like/:id                             | X   | ALL             |
|                  | 2.7 ì´ë¯¸ì§€ ì—…ë¡œë“œ      | POST        | /common/image                              | O   | ADMIN           |
| 3. ëŒ“ê¸€ ê´€ë¦¬     | 3.1 ëŒ“ê¸€ ì‘ì„±(íšŒì›)    | POST        | /post/comment/user                         | O   | USER            |
|                  | 3.2 ëŒ“ê¸€ ìˆ˜ì •(íšŒì›)    | PATCH       | /post/comment/user/:id                     | O   | USER            |
|                  | 3.3 ëŒ“ê¸€ ì‚­ì œ(íšŒì›)    | DELETE      | /post/comment/user/:id                     | O   | USER            |
|                  | 3.4 ëŒ“ê¸€ ì‘ì„±(ë¹„íšŒì›)  | POST        | /post/comment/guest                        | X   | ALL             |
|                  | 3.5 ëŒ“ê¸€ ìˆ˜ì •(ë¹„íšŒì›)  | PATCH       | /post/comment/guest/:id                    | X   | ALL             |
|                  | 3.6 ëŒ“ê¸€ ì‚­ì œ(ë¹„íšŒì›)  | DELETE      | /post/comment/guest/:id                    | X   | ALL             |
| 4. íƒœê·¸ ê´€ë¦¬     | 4.1 íƒœê·¸ ëª©ë¡ ì¡°íšŒ     | GET         | /tag                                       | X   | ALL             |
|                  | 4.2 íƒœê·¸ ìƒì„¸ ì¡°íšŒ     | GET         | /tag/:id                                   | X   | ALL             |
|                  | 4.3 íƒœê·¸ ìƒì„±          | POST        | /tag                                       | O   | ADMIN           |
|                  | 4.4 íƒœê·¸ ìˆ˜ì •          | PATCH       | /tag/:id                                   | O   | ADMIN           |
|                  | 4.5 íƒœê·¸ ì‚­ì œ          | DELETE      | /tag/:id                                   | O   | ADMIN           |
| 5. ì¹´í…Œê³ ë¦¬ ê´€ë¦¬ | 5.1 ì¹´í…Œê³ ë¦¬ ëª©ë¡ ì¡°íšŒ | GET         | /category                                  | X   | ALL             |
|                  | 5.2 ì¹´í…Œê³ ë¦¬ ìƒì„¸ ì¡°íšŒ | GET         | /category/:id                              | X   | ALL             |
|                  | 5.3 ì¹´í…Œê³ ë¦¬ ìƒì„±      | POST        | /category                                  | O   | ADMIN           |
|                  | 5.4 ì¹´í…Œê³ ë¦¬ ìˆ˜ì •      | PATCH       | /category/:id                              | O   | ADMIN           |
|                  | 5.5 ì¹´í…Œê³ ë¦¬ ì‚­ì œ      | DELETE      | /category/:id                              | O   | ADMIN           |

## ğŸ“Œ 6. ERD ì„¤ê³„

```mermaid
erDiagram
"GuestComment" {
  Int id PK
  String nickName
  String email
  String password
  String guestId FK
}
"Guest" {
  Int id PK
  String guestId UK
}
"Category" {
  Int id PK
  String name UK
  DateTime createdAt
  DateTime updatedAt
}
"Comment" {
  Int id PK
  String content
  DateTime createdAt
  DateTime updatedAt
  Int parentCommentId FK "nullable"
  Int postId FK
  Int authorId FK "nullable"
  Int guestId FK "nullable"
}
"Image" {
  Int id PK
  String url
  Int postId FK
}
"PostLike" {
  Int postId FK
  String guestId FK
  DateTime createdAt
}
"Post" {
  Int id PK
  String title UK
  String content
  DateTime createdAt
  DateTime updatedAt
  Int prevId "nullable"
  Int nextId "nullable"
  Boolean draft
  String summary
  Int views
  Int likes
  Int authorId FK
  Int categoryId FK
}
"Tag" {
  Int id PK
  String name UK
}
"User" {
  Int id PK
  String name
  String email UK
  String password "nullable"
  Role role
  DateTime createdAt
  String providerId UK "nullable"
}
"_PostToTag" {
  String A FK
  String B FK
}
"GuestComment" }o--|| "Guest" : guest
"Comment" }o--o| "Comment" : parentComment
"Comment" }o--|| "Post" : post
"Comment" }o--o| "User" : author
"Comment" |o--o| "GuestComment" : guest
"Image" }o--|| "Post" : post
"PostLike" }o--|| "Post" : post
"PostLike" }o--|| "Guest" : guest
"Post" }o--|| "User" : author
"Post" }o--|| "Category" : category
"_PostToTag" }o--|| "Post" : Post
"_PostToTag" }o--|| "Tag" : Tag
```

### `GuestComment`

ë¹„íšŒì› ëŒ“ê¸€ í…Œì´ë¸”

**Properties**

- `id`: Primary Key
- `nickName`: ë‹‰ë„¤ì„
- `email`: ì´ë©”ì¼
- `password`: ë¹„ë°€ë²ˆí˜¸(í•´ì‹œê°’)
- `guestId`
  > Foreign Key
  >
  > ì‘ì„±ì(ë¹„íšŒì›) ID [Guest.guestId](#Guest)

### `Guest`

ë¹„íšŒì› í…Œì´ë¸”

**Properties**

- `id`: Primary Key
- `guestId`: ë¹„íšŒì› id, í”„ë¡ íŠ¸ì—ì„œ ìƒì„±

### `Category`

ì¹´í…Œê³ ë¦¬ í…Œì´ë¸”

**Properties**

- `id`: Primary Key
- `name`: ì¹´í…Œê³ ë¦¬ ì´ë¦„
- `createdAt`: ìƒì„±ì¼
- `updatedAt`: ìˆ˜ì •ì¼

### `Comment`

ëŒ“ê¸€ í…Œì´ë¸”

**Properties**

- `id`: Primary Key
- `content`: ë‚´ìš©
- `createdAt`: ìƒì„±ì¼
- `updatedAt`: ìˆ˜ì •ì¼
- `parentCommentId`
  > Foreign Key
  >
  > ë¶€ëª¨ ëŒ“ê¸€ ID [Comment.id](#Comment)
- `postId`
  > Foreign Key
  >
  > ê²Œì‹œê¸€ ID [Post.id](#Post)
- `authorId`
  > Foreign Key
  >
  > ì‘ì„±ì(íšŒì›) ID [User.id](#User)
- `guestId`
  > Foreign Key
  >
  > ì‘ì„±ì(ë¹„íšŒì›) ID [GuestComment.id](#GuestComment)

### `Image`

ì´ë¯¸ì§€ í…Œì´ë¸”

**Properties**

- `id`: Primary Key
- `url`: ì´ë¯¸ì§€ url
- `postId`
  > Foreign Key
  >
  > ê²Œì‹œê¸€ ID [Post.id](#Post)

### `PostLike`

ë¹„íšŒì› <=> ê²Œì‹œê¸€ : ë‹¤ëŒ€ë‹¤, ê²Œì‹œê¸€ ì¢‹ì•„ìš” í…Œì´ë¸”

**Properties**

- `postId`
  > Foreign Key
  >
  > ê²Œì‹œê¸€ ID [Post.id](#Post)
- `guestId`
  > Foreign Key
  >
  > ë¹„íšŒì› ID [Guest.guestId](#Guest)
- `createdAt`: ì¢‹ì•„ìš”ê°€ ëˆŒë¦° ë‚ ì§œ

### `Post`

ê²Œì‹œê¸€ í…Œì´ë¸”

**Properties**

- `id`: Primary Key
- `title`: ì œëª©
- `content`: ë‚´ìš©
- `createdAt`: ìƒì„±ì¼
- `updatedAt`: ìˆ˜ì •ì¼
- `prevId`: ì´ì „ ê²Œì‹œê¸€ Id
- `nextId`: ë‹¤ìŒ ê²Œì‹œê¸€ Id
- `draft`: ì´ˆì•ˆ
- `summary`: ë‚´ìš© ìš”ì•½
- `views`: ì¡°íšŒìˆ˜
- `likes`: ì¢‹ì•„ìš”ìˆ˜
- `authorId`
  > Foreign Key
  >
  > ì‘ì„±ì ID [User.id](#User)
- `categoryId`
  > Foreign Key
  >
  > ì‘ì„±ì ID [Category.id](#Category)

### `Tag`

íƒœê·¸ í…Œì´ë¸”

**Properties**

- `id`: Primary Key
- `name`: íƒœê·¸ ì´ë¦„

### `User`

íšŒì› í…Œì´ë¸”

**Properties**

- `id`: Primary Key
- `name`: ì´ë¦„
- `email`: ì´ë©”ì¼
- `password`: ë¹„ë°€ë²ˆí˜¸(í•´ì‹œê°’)
- `role`: ì—­í• 
- `createdAt`: ìƒì„±ì¼
- `providerId`: OAuth Id

### `_PostToTag`

Pair relationship table between [Post](#Post) and [Tag](#Tag)

**Properties**

- `A`:
- `B`:
